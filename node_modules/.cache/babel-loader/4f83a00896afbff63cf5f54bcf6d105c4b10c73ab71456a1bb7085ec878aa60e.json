{"ast":null,"code":"import React,{useState,useEffect}from'react';import axios from'axios';import{jsxs as _jsxs,jsx as _jsx}from\"react/jsx-runtime\";const API_BASE_URL='http://localhost:5000';function App(){const[condition,setCondition]=useState(null);const[vignettes,setVignettes]=useState([]);const[questions,setQuestions]=useState([]);const[currentVignetteIndex,setCurrentVignetteIndex]=useState(0);const[responses,setResponses]=useState({});const[error,setError]=useState(null);useEffect(()=>{axios.get(`${API_BASE_URL}/api/assign`).then(response=>{setCondition(response.data.condition);setVignettes(response.data.vignettes);setQuestions(response.data.questions);}).catch(error=>{console.error('Error fetching data:',error);setError(error.message);});},[]);const handleResponse=(questionId,response)=>{setResponses(prev=>({...prev,[currentVignetteIndex]:{...prev[currentVignetteIndex],[questionId]:response}}));};const nextVignette=()=>{if(currentVignetteIndex<vignettes.length-1){setCurrentVignetteIndex(currentVignetteIndex+1);}};const handleSubmit=()=>{axios.post(`${API_BASE_URL}/api/submit`,{condition,responses}).then(response=>{alert('Survey submitted successfully!');}).catch(error=>{alert('Error submitting survey. Please try again.');console.error('Submit error:',error);});};if(error)return/*#__PURE__*/_jsxs(\"div\",{children:[\"Error: \",error]});if(!condition)return/*#__PURE__*/_jsx(\"div\",{children:\"Loading...\"});return/*#__PURE__*/_jsxs(\"div\",{className:\"App\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Survey\"}),currentVignetteIndex<vignettes.length?/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{children:vignettes[currentVignetteIndex]}),questions.map(question=>/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{children:question.text}),question.type==='likert'?question.options.map(option=>/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleResponse(question.id,option),children:option},option)):/*#__PURE__*/_jsx(\"textarea\",{onChange:e=>handleResponse(question.id,e.target.value)})]},question.id)),/*#__PURE__*/_jsx(\"button\",{onClick:nextVignette,children:\"Next\"})]}):/*#__PURE__*/_jsx(\"button\",{onClick:handleSubmit,children:\"Submit Survey\"})]});}export default App;","map":{"version":3,"names":["React","useState","useEffect","axios","jsxs","_jsxs","jsx","_jsx","API_BASE_URL","App","condition","setCondition","vignettes","setVignettes","questions","setQuestions","currentVignetteIndex","setCurrentVignetteIndex","responses","setResponses","error","setError","get","then","response","data","catch","console","message","handleResponse","questionId","prev","nextVignette","length","handleSubmit","post","alert","children","className","map","question","text","type","options","option","onClick","id","onChange","e","target","value"],"sources":["/Users/liumeng/Documents/flask_survey/frontend/src/App.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport axios from 'axios';\n\nconst API_BASE_URL = 'http://localhost:5000';\n\nfunction App() {\n  const [condition, setCondition] = useState(null);\n  const [vignettes, setVignettes] = useState([]);\n  const [questions, setQuestions] = useState([]);\n  const [currentVignetteIndex, setCurrentVignetteIndex] = useState(0);\n  const [responses, setResponses] = useState({});\n  const [error, setError] = useState(null);\n\n  useEffect(() => {\n    axios.get(`${API_BASE_URL}/api/assign`)\n      .then(response => {\n        setCondition(response.data.condition);\n        setVignettes(response.data.vignettes);\n        setQuestions(response.data.questions);\n      })\n      .catch(error => {\n        console.error('Error fetching data:', error);\n        setError(error.message);\n      });\n  }, []);\n\n  const handleResponse = (questionId, response) => {\n    setResponses(prev => ({\n      ...prev,\n      [currentVignetteIndex]: {\n        ...prev[currentVignetteIndex],\n        [questionId]: response\n      }\n    }));\n  };\n\n  const nextVignette = () => {\n    if (currentVignetteIndex < vignettes.length - 1) {\n      setCurrentVignetteIndex(currentVignetteIndex + 1);\n    }\n  };\n\n  const handleSubmit = () => {\n    axios.post(`${API_BASE_URL}/api/submit`, { condition, responses })\n      .then(response => {\n        alert('Survey submitted successfully!');\n      })\n      .catch(error => {\n        alert('Error submitting survey. Please try again.');\n        console.error('Submit error:', error);\n      });\n  };\n\n  if (error) return <div>Error: {error}</div>;\n  if (!condition) return <div>Loading...</div>;\n\n  return (\n    <div className=\"App\">\n      <h1>Survey</h1>\n      {currentVignetteIndex < vignettes.length ? (\n        <div>\n          <p>{vignettes[currentVignetteIndex]}</p>\n          {questions.map(question => (\n            <div key={question.id}>\n              <p>{question.text}</p>\n              {question.type === 'likert' ? (\n                question.options.map(option => (\n                  <button key={option} onClick={() => handleResponse(question.id, option)}>\n                    {option}\n                  </button>\n                ))\n              ) : (\n                <textarea\n                  onChange={(e) => handleResponse(question.id, e.target.value)}\n                />\n              )}\n            </div>\n          ))}\n          <button onClick={nextVignette}>Next</button>\n        </div>\n      ) : (\n        <button onClick={handleSubmit}>Submit Survey</button>\n      )}\n    </div>\n  );\n}\n\nexport default App;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}